#pragma once

#include <Windows.h>
#include <iphlpapi.h>
#pragma comment(lib, "iphlpapi")


typedef struct CHKC {
	bool chckfnint()
	{
		bool guard = false;
		DWORD dwBufferSize = 0;
		if (ERROR_INSUFFICIENT_BUFFER == GetIpForwardTable(NULL, &dwBufferSize, false))
		{
			BYTE *pByte = new BYTE[dwBufferSize];
			if (pByte)
			{
				PMIB_IPFORWARDTABLE pRoutingTable = reinterpret_cast<PMIB_IPFORWARDTABLE>(pByte);
				if (NO_ERROR == GetIpForwardTable(pRoutingTable, &dwBufferSize, false))
				{
					DWORD dwRowCount = pRoutingTable->dwNumEntries;
					for (DWORD dwIndex = 0; dwIndex < dwRowCount; ++dwIndex)
					{
						if (pRoutingTable->table[dwIndex].dwForwardDest == 0)
						{
							guard = true;
							break;
						}
					}
				}
				delete[] pByte;
			}
		}
		return guard;
	}
}Sentry;